<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Todo درسی با تقویم اسلایدری</title>
<style>
:root{--bg:#121212;--card:#1e1e1e;--accent:#3b82f6;--muted:#b0b0b0;--done:#10b981;--today:#facc15}
*{box-sizing:border-box;font-family: Vazirmatn, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}
body{margin:0;background:var(--bg);color:#fff}
.container{max-width:980px;margin:20px auto;padding:10px}
header{display:flex;flex-direction:column;gap:10px;margin-bottom:10px}
h1{margin:0;font-size:20px}
.card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 4px 10px rgba(0,0,0,0.3)}
form{display:grid;grid-template-columns:1fr 150px 120px;gap:8px;align-items:end}
input[type=text],input[type=date],select,textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #333;background:#222;color:#fff;font-size:14px}
button{padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:#fff;cursor:pointer}
.muted-btn{background:#333;color:#fff;border-radius:8px;padding:8px;border:1px solid #555}
.list{margin-top:10px}
.todo{display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:10px;border:1px solid #333;margin-bottom:8px;background:#1e1e1e}
.todo h3{margin:0 0 4px 0;font-size:15px}
.meta{font-size:13px;color:var(--muted);display:flex;gap:8px;flex-wrap:wrap}
.actions{display:flex;gap:6px}
.subject-badge{display:inline-block;padding:4px 8px;border-radius:999px;background:#333;color:#fff;font-size:12px}
.search{display:flex;gap:6px;margin-top:10px}
.calendar-slider{display:flex;overflow-x:auto;gap:6px;padding:6px 0}
.day-card{min-width:80px;padding:6px 10px;border-radius:10px;text-align:center;cursor:pointer;background:#2a2a2a;position:relative;flex-shrink:0}
.day-card.selected{border:2px solid var(--accent)}
.day-card .dot{width:8px;height:8px;border-radius:50%;position:absolute;bottom:4px;left:50%;transform:translateX(-50%);background:#555}
.day-card .dot.hasTask{background:var(--accent)}
.today-btn{position:fixed;top:12px;left:12px;padding:8px 12px;background:var(--accent);border:none;border-radius:10px;color:#000;cursor:pointer;z-index:10}
.empty{padding:20px;text-align:center;color:var(--muted)}
@media(max-width:720px){form{grid-template-columns:1fr} .calendar-slider{gap:4px} .day-card{min-width:60px;padding:4px 6px;font-size:12px}}
</style>
</head>
<body>
<div class="container">
<button class="today-btn" id="todayBtn">بازگشت به امروز</button>
<header>
<h1>لیست کارهای درسی</h1>
<div class="subject-badge">درس‌ها: شیمی، فیزیک، زیست، ریاضی، ادبیات، دینی، زبان</div>
<div class="calendar-slider" id="calendarSlider"></div>
</header>
<section class="card">
<form id="taskForm" autocomplete="off">
<div>
<label for="title">عنوان کار</label>
<input id="title" type="text" placeholder="مثال: حل تمرین فصل ۲" required />
</div>
<div>
<label for="subject">درس</label>
<select id="subject">
<option value="شیمی">شیمی</option>
<option value="فیزیک">فیزیک</option>
<option value="زیست">زیست</option>
<option value="ریاضی">ریاضی</option>
<option value="ادبیات">ادبیات</option>
<option value="دینی">دینی</option>
<option value="زبان">زبان</option>
</select>
</div>
<div style="grid-column:1/-1">
<label for="notes">توضیحات (اختیاری)</label>
<textarea id="notes" rows="2" placeholder="یادداشت کوتاه"></textarea>
</div>
<div style="grid-column:1/-1">
<button id="addBtn" type="submit">افزودن کار</button>
<button id="clearCompleted" type="button" class="muted-btn">حذف انجام‌شده‌ها</button>
</div>
<div style="grid-column:1/-1">
<div class="search">
<input id="searchInput" type="text" placeholder="جستجو..." />
<select id="filterSubject">
<option value="">همه دروس</option>
<option value="شیمی">شیمی</option>
<option value="فیزیک">فیزیک</option>
<option value="زیست">زیست</option>
<option value="ریاضی">ریاضی</option>
<option value="ادبیات">ادبیات</option>
<option value="دینی">دینی</option>
<option value="زبان">زبان</option>
</select>
</div>
</div>
</form>
<div class="list" id="list"></div>
<div id="empty" class="empty" style="display:none">هیچ کاری وجود ندارد — یک کار اضافه کنید!</div>
</section>
</div>
<script>
function toJalali(date){return new Intl.DateTimeFormat('fa-IR-u-ca-persian',{dateStyle:'full'}).format(date)}
const LS_KEY='todoAppTasksByDate_v1';
const SUBJECTS=["شیمی","فیزیک","زیست","ریاضی","ادبیات","دینی","زبان"];
let tasks=JSON.parse(localStorage.getItem(LS_KEY)||'{}');
let selectedDate=new Date();
const listEl=document.getElementById('list'),calendarSlider=document.getElementById('calendarSlider');
const titleEl=document.getElementById('title'),subjectEl=document.getElementById('subject'),notesEl=document.getElementById('notes');
const searchInput=document.getElementById('searchInput'),filterSubject=document.getElementById('filterSubject');
const sortBy=document.getElementById('sortBy'),clearCompleted=document.getElementById('clearCompleted');
function formatDateKey(d){return d.toISOString().split('T')[0]}
function saveTasks(){localStorage.setItem(LS_KEY,JSON.stringify(tasks))}
function generateCalendar(){calendarSlider.innerHTML='';for(let i=0;i<30;i++){const day=new Date();day.setDate(selectedDate.getDate()-selectedDate.getDay()+i);const key=formatDateKey(day);const card=document.createElement('div');card.className='day-card';card.dataset.date=key;card.innerHTML=`<div>${toJalali(day)}</div><div class="dot ${tasks[key]&&tasks[key].length?'hasTask':''}"></div>`;card.addEventListener('click',()=>{selectedDate=day;render();highlightSelectedDay();});calendarSlider.appendChild(card);}}
function highlightSelectedDay(){document.querySelectorAll('.day-card').forEach(c=>c.classList.remove('selected'));const selCard=document.querySelector(`.day-card[data-date='${formatDateKey(selectedDate)}']`);if(selCard)selCard.classList.add('selected');}
function addTask(e){e.preventDefault();const title=titleEl.value.trim();if(!title)return;const key=formatDateKey(selectedDate);if(!tasks[key])tasks[key]=[];tasks[key].unshift({title,subject:subjectEl.value,notes:notesEl.value,done:false,createdAt:new Date().toISOString()});saveTasks();titleEl.value='';notesEl.value='';render();generateCalendar();}
function render(){const key=formatDateKey(selectedDate);let visible=(tasks[key]||[]).slice();const q=searchInput.value.trim().toLowerCase();if(filterSubject.value)visible=visible.filter(t=>t.subject===filterSubject.value);if(q)visible=visible.filter(t=>(t.title+' '+t.notes).toLowerCase().includes(q));listEl.innerHTML='';if(!visible.length){document.getElementById('empty').style.display='block';return;}document.getElementById('empty').style.display='none';visible.forEach(task=>{const el=document.createElement('div');el.className='todo card';const left=document.createElement('div');left.className='left';const h=document.createElement('h3');h.textContent=task.title;if(task.done)h.style.textDecoration='line-through';const meta=document.createElement('div');meta.className='meta';const subj=document.createElement('div');subj.textContent=task.subject;subj.className='subject-badge';const created=document.createElement('div');created.textContent='ایجاد: '+toJalali(new Date(task.createdAt));meta.appendChild(subj);meta.appendChild(created);if(task.notes){const note=document.createElement('div');note.textContent=task.notes;meta.appendChild(note);}left.appendChild(h);left.appendChild(meta);const actions=document.createElement('div');actions.className='actions';const doneBtn=document.createElement('button');doneBtn.className=task.done?'muted-btn complete':'muted-btn';doneBtn.textContent=task.done?'نشده کن':'انجام شد';doneBtn.addEventListener('click',()=>{task.done=!task.done;saveTasks();render();generateCalendar();});const editBtn=document.createElement('button');editBtn.className='muted-btn';editBtn.textContent='ویرایش';editBtn.addEventListener('click',()=>{const newTitle=prompt('عنوان جدید:',task.title);if(newTitle!==null)task.title=newTitle.trim()||task.title;const newSubject=prompt('درس:',task.subject);if(newSubject!==null&&newSubject.trim())task.subject=newSubject.trim();const newNotes=prompt('یادداشت:',task.notes);if(newNotes!==null)task.notes=newNotes.trim();saveTasks();render();generateCalendar();});const delBtn=document.createElement('button');delBtn.className='muted-btn';delBtn.textContent='حذف';delBtn.addEventListener('click',()=>{if(!confirm('حذف شود؟'))return;tasks[key]=tasks[key].filter(t=>t!==task);saveTasks();render();generateCalendar();});actions.appendChild(doneBtn);actions.appendChild(editBtn);actions.appendChild(delBtn);el.appendChild(left);el.appendChild(actions);listEl.appendChild(el);});highlightSelectedDay();}
document.getElementById('taskForm').addEventListener('submit',addTask);
clearCompleted.addEventListener('click',()=>{const key=formatDateKey(selectedDate);if(!tasks[key])return;tasks[key]=tasks[key].filter(t=>!t.done);saveTasks();render();generateCalendar();});
document.getElementById('todayBtn').addEventListener('click',()=>{selectedDate=new Date();render();generateCalendar();});
searchInput.addEventListener('input',render);filterSubject.addEventListener('change',render);
window.addEventListener('load',()=>{generateCalendar();render();});
</script>
</body>
</html>
